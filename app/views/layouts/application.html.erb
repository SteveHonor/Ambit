<!DOCTYPE html>
<html>
<head>
  <title>Ambit</title>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>
</head>
<body>
  <header class="navbar">
    <div class="top-panel">
      <div class="col-sm-1">
        <div class="icon-menu" id="toggle-menu">
          <i class="fa fa-bars"></i>
          <span>Menu</span>
        </div>
      </div>
      <div class="col-sm-1">
       <p class="fields">AMBIT</p>
     </div>
     <div class="pull-right">
      <ul class="nav navbar-nav panel-menu">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle account" data-toggle="dropdown">
            <div class="avatar">
              <%= image_tag(current_user.avatar) %>
            </div>
            <i class="fa fa-angle-down pull-right"></i>
            <div class="user-mini pull-right">
              <span class="welcome">Bem Vindo,</span>
              <span><%= current_user.name %></span>
            </div>
          </a>
          <ul class="dropdown-menu">
          <li>
            <%= link_to '/users/edit' do %>
            <i class="fa fa-cog"></i>
            <span>Configurações</span>
            <% end %>
          </li>
          <li>
            <%= link_to '/users/sign_out' do %>
            <i class="fa fa-power-off"></i>
            <span>Sair</span>
            <% end %>
          </li>
        </ul>
      </li>
    </ul>
  </div>

  <div class="col-sm-1 pull-right">
   <p class="fields">Assis</p>
 </div>

 <div class="col-sm-1 pull-right">
   <p class="fields">São Paulo</p>
 </div>
</div>
</header>

<div id="menu" class="menu">
  <ul id="accordion" class="accordion">
    <li>
      <a href="/"><div class="link"><i class="fa fa-globe"></i>Dashboard</div></a>
    </li>

    <li>
      <div class="link"><i class="fa fa-archive"></i>Cadastros<i class="fa fa-chevron-down"></i></div>
      <ul class="submenu">
        <li><a href="/users"><i class="fa fa-user"></i>Usuários</a></li>
        <li><a href="/laws"><i class="fa fa-legal"></i>Leis</a></li>
      </ul>
    </li>

    <li>
      <div class="link"><i class="fa fa-search"></i>Fiscalização<i class="fa fa-chevron-down"></i></div>
      <ul class="submenu" style="display: none;">
        <li><a href="/supervision/notifications/">Notificação</a></li>
      </ul>
    </li>

    <li>
      <a href="/users/sign_out">
        <div class="link">
          <i class="fa fa-power-off"></i>Sair
        </div>
      </a>
    </li>
  </ul>
</div>

  <div id="map-canvas"></div>
<div class="content">
  <div class="row">
    <%= yield %>
  </div>
</div>
<script type="text/javascript">
  $('#optgroup').multiSelect({ selectableOptgroup: true });
</script>

<script type="text/javascript">
  $("#toggle-menu").click(function () {
    var effect   = 'slide';
    var options  = { direction: 'left' };
    var duration = 600;

    $('#menu').toggle(effect, options, duration);

    $('#mega-1').dcVerticalMegaMenu();
  });

  $(document).ready(function($) {
  if (location.pathname+location.search != "/"){

    $('#menu').toggle();
  }

    $('#mega-1').dcVerticalMegaMenu();
  });
</script>

<script>
  $(function() {
    var Accordion = function(el, multiple) {
      this.el = el || {};
      this.multiple = multiple || false;

    // Variables privadas
    var links = this.el.find('.link');
    // Evento
    links.on('click', {el: this.el, multiple: this.multiple}, this.dropdown)
  }

  Accordion.prototype.dropdown = function(e) {
    var $el = e.data.el;
    $this = $(this),
    $next = $this.next();

    $next.slideToggle();
    $this.parent().toggleClass('open');

    if (!e.data.multiple) {
      $el.find('.submenu').not($next).slideUp().parent().removeClass('open');
    };
  }

  var accordion = new Accordion($('#accordion'), false);
});
</script>
</body>
</html>
