<!DOCTYPE html>
<html>
<head>
  <title>Ambit</title>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>
</head>
<body>
  <header class="navbar">
    <div class="top-panel">
      <div class="col-sm-1">
        <div class="icon-menu" id="toggle-menu">
          <i class="fa fa-bars"></i>
          <span>Menu</span>
        </div>
      </div>

      <div class="col-sm-1 pull-right">
        <p class="fields"><%= current_user.name %></p>
      </div>

      <div class="col-sm-1 pull-right">
        <p class="fields"><%= current_user.management.state %></p>
      </div>

      <div class="col-sm-1 pull-right">
        <p class="fields"><%= current_user.management.prefecture %></p>
      </div>

      <div class="col-sm-3 pull-right">
        <p class="fields"><%= current_user.management.name %></p>
      </div>

      <div class="col-sm-2 pull-right">
        <p class="fields"><%= current_user.user_type %></p>
      </div>
    </div>
  </header>

  <div id="menu" class="menu">
    <ul id="accordion" class="accordion">
      <li>
        <a href="/"><div class="link"><i class="fa fa-home"></i></i>Inicio</div></a>
      </li>

      <li>
        <div class="link"><i class="fa fa-archive"></i>Cadastros<i class="fa fa-chevron-down"></i></div>
        <ul class="submenu">
          <li><a href="/infractions/"><i class="fa fa-exclamation-circle"></i>Infrações</a></li>
          <li><a href="/users"><i class="fa fa-user"></i>Usuários</a></li>
          <li><a href="/laws"><i class="fa fa-legal"></i>Leis</a></li>
          <li><a href="/managements"><i class="fa fa-home"></i>Unidade</a></li>
        </ul>
      </li>

      <li>
        <div class="link"><i class="fa fa-tree"></i>Arborização<i class="fa fa-chevron-down"></i></div>
        <ul class="submenu">
          <!-- <li><a href="/infractions/"><i class="fa fa-exclamation-circle"></i>Infrações</a></li>
          <li><a href="/users"><i class="fa fa-user"></i>Usuários</a></li>
          <li><a href="/laws"><i class="fa fa-legal"></i>Leis</a></li> -->
        </ul>
      </li>

      <li>
        <div class="link"><i class="fa fa-search"></i>Fiscalização<i class="fa fa-chevron-down"></i></div>
        <ul class="submenu" style="display: none;">
          <li><a href="/supervisions/infractions/"><i class="fa fa-exclamation"></i>Infrações</a></li>
        </ul>
      </li>

      <li>
        <a href="/users/sign_out">
          <div class="link">
            <i class="fa fa-power-off"></i>Sair
          </div>
        </a>
      </li>
    </ul>
  </div>

  <div id="map-canvas"></div>
  <div class="content">
    <div class="row">
      <%= yield %>
    </div>
  </div>

  <script type="text/javascript">
  $("#toggle-menu").click(function () {
    var effect   = 'slide';
    var options  = { direction: 'left' };
    var duration = 600;

    $('#menu').toggle(effect, options, duration);

    $('#mega-1').dcVerticalMegaMenu();
  });

  $(document).ready(function($) {
    if (location.pathname+location.search != "/"){

      $('#menu').toggle();
    }

    $('#mega-1').dcVerticalMegaMenu();
  });
  </script>

  <script>
  $(function() {
    var Accordion = function(el, multiple) {
      this.el = el || {};
      this.multiple = multiple || false;

      // Variables privadas
      var links = this.el.find('.link');
      // Evento
      links.on('click', {el: this.el, multiple: this.multiple}, this.dropdown)
    }

    Accordion.prototype.dropdown = function(e) {
      var $el = e.data.el;
      $this = $(this),
      $next = $this.next();

      $next.slideToggle();
      $this.parent().toggleClass('open');

      if (!e.data.multiple) {
        $el.find('.submenu').not($next).slideUp().parent().removeClass('open');
      };
    }

    var accordion = new Accordion($('#accordion'), false);
  });
  </script>
  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog-big">
      <div class="modal-content">
        <div class="modal-header">
          <div class="pull-right">
            <button type="button" class="btn btn-default" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <h4 class="modal-title" id="myModalLabel"><i class="fa fa-gavel"></i> Autuação</h4>
        </div>
        <div class="modal-body" id="myModalBody"></div>

      </div>
    </div>
  </div>
</body>
</html>
